---
name: "api-document-generation"
description: "自动扫描指定的库文件或源代码，智能识别项目编程语言与上下文环境，生成包含数据结构、函数接口、参数说明及使用示例的标准化 API 文档。"
---

# API 文档生成专家 (API Document Generator)

本技能专注于解析指定的库文件（头文件、源码文件），自动提取接口定义、数据结构和注释信息，生成一份格式统一、细节详尽的 API 技术文档。该技能设计为**自适应通用型**，不限制于特定领域，而是通过智能分析项目的代码特征、依赖关系和文件结构，自动识别开发语境（如语言特性、框架约束、并发模型等），并生成最适合当前项目的文档。

## 目标 (Goals)

1.  **智能识别 (Intelligent Identification)**：自动检测编程语言、项目类型（如库开发、服务开发、驱动开发）及使用的核心框架。
2.  **动态适配 (Dynamic Adaptation)**：根据识别到的上下文调整文档重点（例如：针对异步框架强调 `await`，针对底层开发强调中断安全性，针对 Web API 强调 HTTP 方法）。
3.  **精准解析 (Accurate Parsing)**：准确提取函数签名、类/结构体定义、枚举值及关键修饰符。
4.  **规范输出 (Standardized Output)**：生成结构清晰的 Markdown 文档，包含参数表、返回值说明及符合当前语境的代码示例。

## 执行流程 (Execution Flow)

当用户提供代码文件并请求“生成 API 文档”时：

1.  **环境与上下文分析 (Context Analysis)**

    - **扫描项目特征**：检查根目录配置文件（如 `package.json`, `CMakeLists.txt`, `requirements.txt`, `go.mod` 等）以确定技术栈。
    - **识别语言特性**：分析源代码扩展名及语法特征（如 C++ 模板、Python 装饰器、Go 接口、Rust Trait）。
    - **推断开发模式**：
      - 检测并发模型（多线程、协程、事件循环）。
      - 检测运行环境（OS 内核、裸机、容器、浏览器）。

2.  **深度解析 (Deep Parse)**

    - 提取**核心对象**：类、结构体、接口、全局配置对象。
    - 提取**功能接口**：公共函数、导出方法、API 端点。
    - 提取**约束元数据**：
      - 输入/输出参数及其类型约束。
      - 错误处理机制（异常类型、错误码、Option/Result 返回值）。
      - 关键修饰符（`static`, `const`, `async`, `unsafe`, `synchronized`）。

3.  **文档生成 (Generate)**
    - 使用下方的 [通用 API 文档模板] 进行渲染。
    - **智能填充“注意事项”**：根据分析结果自动补充关键提示。
      - _例如：检测到互斥锁使用，提示“线程安全”；检测到底层寄存器操作，提示“不可重入”；检测到网络库调用，提示“可能阻塞”。_

## 通用 API 文档模板 (Universal API Template)

````markdown
# [库/模块名称] API 参考文档

> 自动识别环境：[如：Python 3.10 / C++17 / Node.js]
> 框架/依赖：[如：FastAPI / Qt / STM32 HAL]

## 1. 概述 (Overview)

[简要描述该库或文件的主要功能、设计目的及核心职责。]

## 2. 核心数据结构 (Core Data Structures)

### 2.1 [类型名称]

- **定义**：

```[语言]
[源代码片段]
```
````

- **字段/成员说明**：
  | 名称 | 类型 | 描述 |
  | :--- | :--- | :--- |
  | `[Name]` | `[Type]` | [Description] |

## 3. 接口详情 (API Details)

### 3.1 [函数/方法名称]

> [简短的一句话功能描述]

- **原型**：

```[语言]
[函数签名]
```

- **参数说明**：
  | 参数名 | 方向/类型 | 描述 |
  | :--- | :--- | :--- |
  | `[Param]` | [In/Out/Type] | [详细说明] |

- **返回值**：

  - `[Value/Type]`: [含义说明]

- **注意事项 (Notes)**：

  - [根据上下文生成的提示，如：并发安全性、异常处理、性能影响等]

- **示例 (Example)**：

```[语言]
[符合当前项目风格的调用示例]
```

## 4. 依赖与配置 (Dependencies & Config)

- **依赖项**：[列出必要的外部库或环境要求]
- **配置项**：[相关的宏定义、环境变量或配置参数]

```

## 示例场景 (Example Scenarios)

> 以下仅为示例，实际生成时会根据项目具体情况自动调整。

### 场景 A：数据处理库 (Python/Pandas 风格)

**识别结果**：Python, 数据密集型, 同步调用。
**文档重点**：强调 DataFrame 输入格式，内存使用提示。

### 场景 B：网络服务接口 (Go/Gin)

**识别结果**：Go, Web 服务, 并发。
**文档重点**：强调 Context 传递，Goroutine 安全性，HTTP 状态码。

### 场景 C：硬件抽象层 (C/Rust Embedded)

**识别结果**：C/Rust, 裸机/RTOS。
**文档重点**：强调所有权借用 (Rust) 或 指针生命周期 (C)，中断上下文限制。
```
